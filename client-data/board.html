<!DOCTYPE html>
<html lang="{{language}}">

<head>
	<meta charset="utf-8" />
	<title>{{board}} | WBO | {{translations.collaborative_whiteboard}}</title>
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="stylesheet" type="text/css" href="../board.css" />
	<script src="../socket.io/socket.io.js"></script>
	<meta name="description" content="{{translations.tagline}}" />
	<meta name="keywords"
		content="{{translations.collaborative_whiteboard}},online,draw,paint,shared,realtime,wbo,whitebophir" />
	<link rel="apple-touch-icon" href="../favicon.svg">
	<link rel="icon" type="image/x-icon" sizes="16x16" href="../favicon.ico">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0" />
	<meta property="og:title" content="{{board}} board on WBO" />
	<meta property="og:url" content="{{baseUrl}}/boards/{{boardUriComponent}}" />
	<meta property="og:image" content="{{baseUrl}}/preview/{{boardUriComponent}}" />
	<link rel="canonical" href="{{boardUriComponent}}?lang={{language}}" />
	{{#languages}}
	<link rel="alternate" hreflang="{{.}}" href="{{../boardUriComponent}}?lang={{.}}" />
	{{/languages}}
	<script src="../polyfill.min.js"></script>
</head>

<body>

	<div id="board">
		<svg id="canvas" width="500" height="500" version="1.1" xmlns="http://www.w3.org/2000/svg">
			<defs id="defs"></defs>
			<g id="drawingArea"></g>
			<g id="cursors"></g>
		</svg>
	</div>

	<div id="loadingMessage">{{translations.loading}}</div>

	<!-- The actual snackbar -->
	<div id="snackbar"></div>

	<div id="menu" tabindex="0" {{#hideMenu}}style="display:none;" {{/hideMenu}}>
		<div id="menuItems">
			<ul id="tools" class="tools">
				<li class="tool" tabindex="-1">
					<img class="tool-icon" width="35" height="35" src="" alt="icon" />
					<span class="tool-name"></span>
					<img class="tool-icon secondaryIcon" width="35" height="35" src="data:," alt="icon" />
				</li>
			</ul>

			<ul class="tools" id="settings">
				<li class="tool" tabindex="-1">
					<input class="tool-icon" type="color" id="chooseColor" value="#1913B0" />
					<label class="tool-name" for="chooseColor">{{translations.color}}</label>
					<span class="colorPresets" id="colorPresetSel">
						<span class="colorPresetButton"></span>
					</span>
				</li>
				<li class="tool" tabindex="-1"
					title="{{translations.size}} ({{translations.keyboard_shortcut}}: alt + {{translations.mousewheel}})">
					<img class="tool-icon" width="60" height="60" src="icon-size.svg" alt="size" />
					<label class="tool-name slider" for="chooseSize">
						<span>{{translations.size}}</span>
						<input type="range" id="chooseSize" value="4" min="1" max="50" step="1" class="rangeChooser" />
					</label>
				</li>
				<li class="tool" tabindex="-1">
					<span class="tool-icon">
						<svg viewBox="0 0 8 8">
							<pattern id="opacityPattern" x="0" y="0" width="4" height="4" patternUnits="userSpaceOnUse">
								<rect x=0 y=0 width=2 height=2 fill=black></rect>
								<rect x=2 y=2 width=2 height=2 fill=black></rect>
								<rect x=2 y=0 width=2 height=2 fill=#eeeeee></rect>
								<rect x=0 y=2 width=2 height=2 fill=#eeeeee></rect>
							</pattern>
							<circle cx=4 cy=4 id="opacityIndicator" r=3.5 fill="url(#opacityPattern)"></circle>
						</svg>
					</span>
					<label class="tool-name slider" for="chooseOpacity">
						<span>{{translations.opacity}}</span>
						<input type="range" id="chooseOpacity" value="1" min="0.2" max="1" step="0.1"
							class="rangeChooser" />
					</label>
				</li>
				<li id="home-button" class="tool" tabindex="-1">
					<img class="tool-icon" width="60" height="60" src="icon-home.svg" alt="home" />
					<label class="tool-name">Home</label>
				</li>
			</ul>
		</div>
	</div>

	<!-- The Modal -->
	<div id="myModal" class="modal">

		<!-- Modal content -->
		<div class="modal-content">
			<span class="close">&times;</span>
			<div class="field" id="searchform">
				<input type="text" id="searchterm" placeholder="Write Your Question Here" />
				<button type="button" id="search" onclick="onSubmitQuestion()">Publish</button>
			</div>
		</div>

	</div>

	<div id="open-modal" class="modal-window">
		<div class="modal-window-inner">
			<h1>Questions</h1>
			<ul id='messages'></ul>
		</div>
	</div>
	</div>
	<script>
		// Get the modal
		var modal = document.getElementById("myModal");

		// Get the button that opens the modal
		var btn = document.getElementById("myBtn");

		// Get the <span> element that closes the modal
		var span = document.getElementsByClassName("close")[0];

		// When the user clicks the button, open the modal
		if (btn) {
			btn.onclick = function () {
				modal.style.display = "block";
			}
		}

		// When the user clicks on <span> (x), close the modal
		span.onclick = function () {
			modal.style.display = "none";
		}

		// When the user clicks anywhere outside of the modal, close it
		window.onclick = function (event) {
			if (event.target == modal) {
				modal.style.display = "none";
			}
		}
		async function onSubmitQuestion() {
			var question = {};
			question.questionId = 0
			question.data = ""
			var parts = window.location.href.split('/');
			var lastSegment = parts.pop();
			console.log(lastSegment)

			await fetch('http://localhost:2000/api/v1/board/question', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
				},
				body: JSON.stringify({
					'description': document.getElementById('searchterm').value,
					'boardName': lastSegment
				})
			})
				.then((response) => response.json())
				.then((data) => {
					question.questionId = data
					question.data = document.getElementById('searchterm').value
					Tools.socket.emit("question", { data: question, board: Tools.boardName });
				});

		}
		function handleAnswerSubmit(questionId) {
			console.log(document.getElementById(questionId).value)
			document.getElementById(questionId).style.backgroundColor = "lightsteelblue";
			document.getElementById(questionId).disabled = true;
			// Get the modal
			fetch('http://localhost:2000/api/v1/board/answer', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
				},
				body: JSON.stringify({
					'description': document.getElementById(questionId).value,
					'questionId': questionId
				})
			})
				.then((response) => response.json())

		}
	</script>

	<script type="application/json" id="translations">{{{ json translations }}}</script>
	<script type="application/json" id="configuration">{{{ json configuration }}}</script>
	<script src="../js/path-data-polyfill.js"></script>
	<script src="../js/minitpl.js"></script>
	<script src="../js/intersect.js"></script>
	<script src="../js/board.js"></script>
	<script src="../tools/pencil/wbo_pencil_point.js"></script>
	<script src="../tools/pencil/pencil.js"></script>
	<script src="../tools/cursor/cursor.js"></script>
	<script src="../tools/line/line.js"></script>
	<script src="../tools/rect/rect.js"></script>
	<script src="../tools/ellipse/ellipse.js"></script>
	<script src="../tools/text/text.js"></script>
	<script src="../tools/eraser/eraser.js"></script>
	<script src="../tools/hand/hand.js"></script>
	<script src="../tools/grid/grid.js"></script>
	<script src="../tools/download/download.js"></script>
	<script src="../tools/zoom/zoom.js"></script>
	<script src="https://cdn.rawgit.com/mattdiamond/Recorderjs/08e7abd9/dist/recorder.js"></script>
	<script src="../tools/mic-nlp/mic.js"></script>
	<script src="../tools/question/question.js"></script>
	<script src="../tools/endsession/endsession.js"></script>
	{{#moderator}}
	<script src="../tools/clear/clear.js"></script>{{/moderator}}
	<script src="../js/canvascolor.js"></script>
	{{#viewer}}
	<script src="../js/viewer.js"></script>{{/viewer}}
	{{#editor}}
	<script src="../js/editor.js"></script>{{/editor}}
	{{#owner}}
	<script src="../js/owner.js"></script>{{/owner}}

</body>

</html>